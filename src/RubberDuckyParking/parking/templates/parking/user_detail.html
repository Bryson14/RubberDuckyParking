{% extends 'base.html' %}

{% block content %}
<div id='userDetail'>
    <form>
    <div class="form-group">
    <label for="email">Email address</label>
    <input type="email" class="form-control" id="email" aria-describedby="emailHelp" placeholder="Enter email" name="email" v-model.lazy="user.email">
    <small id="emailHelp" class="form-text text-muted">We'll never share your email with anyone else.</small>
    </div>
    <div class="form-group">
    <label for="first_name">First Name</label>
    <input class="form-control" id="first_name" aria-describedby="emailHelp" placeholder="Enter first name" name="first_name" v-model.lazy="user.first_name">
    </div>
    <div class="form-group">
    <label for="last_name">Last Name</label>
    <input class="form-control" id="last_name" aria-describedby="emailHelp" placeholder="Enter last name" name="last_name" v-model.lazy="user.last_name">
    </div>
    <div class="form-group">
    <label for="username">Username</label>
    <input type="text" class="form-control" id="username" name="username" aria-describedby="usernmaeHelp" placeholder="Enter username" v-model.lazy="user.username">
    </div>
    <button v-on:click="save" class="btn btn-primary">Save</button>
    </form>

</div>


<script>
    axios.defaults.xsrfCookieName = 'csrftoken'
    axios.defaults.xsrfHeaderName = "X-CSRFTOKEN"
    var app = new Vue({
        delimiters: ['[[', ']]'],
        el: '#userDetail',
        data: {
            user: {
                email:'',
                first_name:'',
                last_name:'',
                username:'',
                pk:'',
            }
        },
        created: function() {
            console.log('hello')
            axios.get('/api/users/me').then((res) => {
                this.user = res.data
                console.log(this.user)
            })

        },
        methods: {
            save: function(event) {
                event.preventDefault()
                axios.post(`/api/users/${this.user.pk}/`, data=this.user).then((res) => {
                    console.log(res)
                })
            }

        }

    })
</script>
{% endblock %}
